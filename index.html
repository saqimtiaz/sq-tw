<!DOCTYPE html>
<html>
<head>
	<title>Saq's publicly shared TW files</title>
	<style>
		body{background:#303030;margin:0;font-family:Roboto,Helvetica,Arial,sans-serif;overflow:hidden;display:flex;flex-direction:column;height:100%;width:100%}
		*{color:#fff;text-decoration:none}
		h1{background:#ff1959;font-size:1.3125rem;font-weight:500;line-height:64px;padding:0 20px;box-shadow:0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12);margin:0}
		h1+ul{height:100%;padding:20px;overflow-y:auto;overflow-x:hidden}
		.folder>a:nth-child(1){height:15px;display:inline-block}
		.folder>a:nth-child(1):hover{text-decoration:underline;text-decoration-color:#ff1959}
		.file{position:relative;height:50px}
		.file a{position:absolute;display:inline-block;height:calc(100% - 20px);width:100%;font-size:1rem;font-weight:400;line-height:30px;padding:0 10px;padding-top:4px;margin:10px 0;transition:background-color .5s ease;color:#ff6892}
		.file:hover a{background-color:rgba(255,255,255,.1)}
		ul,ul.tree ul{list-style:none;margin:0;padding:0}
		li{display:block}
		ul ul{margin-left:10px}
		ul li{margin:0;padding:0 20px;color:#369;border-left:1px solid #ff1959}
		ul li:last-child{border-left:none}
		ul li:before{position:relative;height:28px;width:20px;color:#fff;border-bottom:1px solid #ff1959;content:"";display:inline-block;left:-20px}
		ul li:last-child:before{border-left:1px solid #ff1959}
	</style>
</head>
<body>
	<h1>Saq's publicly shared TW files</h1>
	<ul id="file-tree"></ul>

	<script>
	const repoOwner = "saqimtiaz";
	const repoName = "sq-tw";
	const branch = "master";

	const treeRoot = document.getElementById("file-tree");

	function escapeHtml(e){
		return e.replace(/&/g,"&amp;")
				.replace(/</g,"&lt;")
				.replace(/>/g,"&gt;")
				.replace(/"/g,"&quot;")
				.replace(/'/g,"&#039;");
	}

	// Build tree only with .html files
	function buildTree(files, parentEl, path=[]) {
		files.forEach(item => {
			if(item.type === "file" && !item.name.endsWith(".html")) {
				return; // skip non-html files
			}

			const li = document.createElement("li");
			li.setAttribute("class", item.type === "dir" ? "folder" : "file");

			const a = document.createElement("a");
			a.innerHTML = escapeHtml(item.name);
			if(item.type === "file") {
				a.href = `https://raw.githubusercontent.com/${repoOwner}/${repoName}/${branch}/${[...path,item.name].join("/")}`;
			} else {
				a.href = "#";
			}
			li.appendChild(a);

			if(item.type === "dir") {
				const ul = document.createElement("ul");
				li.appendChild(ul);

				// expand/collapse on click
				a.addEventListener("click", (e) => {
					e.preventDefault();
					if(ul.childElementCount === 0) {
						loadDir([...path, item.name].join("/"), ul);
					}
					ul.style.display = (ul.style.display === "none") ? "block" : "none";
				});
			}
			parentEl.appendChild(li);
		});
	}

	function loadDir(path, container) {
		fetch(`https://api.github.com/repos/${repoOwner}/${repoName}/contents/${path}?ref=${branch}`)
			.then(r => r.json())
			.then(data => {
				// keep only dirs or .html files
				const filtered = data.filter(item =>
					item.type === "dir" || (item.type === "file" && item.name.endsWith(".html"))
				);
				buildTree(filtered, container, path.split("/").filter(Boolean));
			});
	}

	// load root
	loadDir("", treeRoot);
	</script>
</body>
</html>
